{{=<% %>=}}
# ⚙️ Generated by InfraBuddy — github.com/alexindevs/infrabuddy

FROM python:3.13-slim

ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1

WORKDIR /app

<%#use_poetry%>
# Install Poetry
RUN pip install poetry

# Copy and install dependencies
COPY poetry.lock pyproject.toml /app/
RUN poetry config virtualenvs.create false \
  && poetry install --no-dev --no-interaction --no-ansi
<%/use_poetry%>

<%^use_poetry%>
# Install with pip
COPY requirements.txt /app/
RUN pip install --no-cache-dir -r requirements.txt
<%/use_poetry%>

# Copy source code
COPY . /app/

EXPOSE <%port%>

<%#use_uvicorn%>
CMD ["poetry", "run", "uvicorn", "<%app_path%>", "--host", "0.0.0.0", "--port", "<%port%>"]
<%/use_uvicorn%>

<%#use_gunicorn%>
CMD ["poetry", "run", "gunicorn", "-k", "uvicorn.workers.UvicornWorker", "<%app_path%>", "--bind", "0.0.0.0:<%port%>"]
<%/use_gunicorn%>

<%#use_pip_runner%>
CMD ["uvicorn", "<%app_path%>", "--host", "0.0.0.0", "--port", "<%port%>"]
<%/use_pip_runner%>
